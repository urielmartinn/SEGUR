RewriteEngine On
RewriteBase /

# Indizeak desgaituta
Options -Indexes



# CSP defektuz ez bada existitzen
<IfModule mod_headers.c>
  Header always setifempty Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self' data:; connect-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'self'"
  # Forzar CSP espec√≠fica para sitemap.xml (elimina cualquier CSP previa y fija la nueva)
  <Files "sitemap.xml">
    Header always unset Content-Security-Policy
    Header always set   Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self' data:; connect-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'self'"
  </Files>
  </IfModule>

# Home
RewriteRule ^$ /index.php [L]

#  Mapeatutako rutak garbi PHP-rentzat /var/www/html
RewriteRule ^register$ /register.php [L,QSA]
RewriteRule ^login$ /login.php [L,QSA]
RewriteRule ^show_user$ /show_user.php [L,QSA]
RewriteRule ^modify_user$ /modify_user.php [L,QSA]
RewriteRule ^items$ /items.php [L,QSA]
RewriteRule ^add_item$ /add_item.php [L,QSA]
RewriteRule ^show_item$ /show_item.php [L,QSA]
RewriteRule ^modify_item$ /modify_item.php [L,QSA]
RewriteRule ^delete_item$ /delete_item.php [L,QSA]
RewriteRule ^logout$ /logout.php [L,QSA]

#  Karpeta edo fitxero bat existituz gero, serbitzatu
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]
